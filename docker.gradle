buildscript {
    repositories {
        gradlePluginPortal()
    }
    dependencies {
        classpath 'com.bmuschko:gradle-docker-plugin:6.6.1'
    }
}

apply plugin: com.bmuschko.gradle.docker.DockerRemoteApiPlugin

import com.bmuschko.gradle.docker.tasks.image.*

def gitCommitHash = 'git rev-parse --verify HEAD'.execute().text.trim()

task buildMyAppImage(type: DockerBuildImage) {
    dependsOn build
    inputDir = file('./')
    images.add("${project.bootJar.baseName}:${gitCommitHash}")
}
